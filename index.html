<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ê±´ê°•Â·ë©˜íƒˆ ê´€ë¦¬ ì›¹ ì™„ì „ì²´</title>
<style>
body{margin:0;font-family:system-ui;background:linear-gradient(135deg,#89f7fe,#66a6ff,#fbc2eb,#a18cd1);color:#333;transition:0.5s;}
.container{max-width:420px;margin:0 auto;padding:15px;}
.screen{display:none;}
.active{display:block;}
button{width:100%;padding:14px;margin:8px 0;border:none;border-radius:12px;background:#5a7cff;color:white;font-size:16px;cursor:pointer;transition:.2s;}
button:hover{opacity:.9;}
h2{margin:0 0 12px;}
.character{font-size:70px;text-align:center;transition:.3s;}
.chat-box{height:250px;overflow-y:auto;background:#f3f5fb;border-radius:14px;padding:12px;margin-bottom:10px;}
.chat-user{text-align:right;margin:6px 0;}
.chat-ai{text-align:left;margin:6px 0;color:#333;}
input,select{width:100%;padding:10px;margin-top:5px;border-radius:12px;border:1px solid #ddd;box-sizing:border-box;}
.small{font-size:13px;color:#666;}
.backBtn{background:#888;margin-top:10px;}
</style>
</head>
<body>
<div class="container">

<!-- ë¡œê·¸ì¸ -->
<div id="loginScreen" class="screen active">
<h2>ğŸ”‘ ë¡œê·¸ì¸ / íšŒì›ê°€ì…</h2>
<input type="text" id="username" placeholder="ì´ë¦„">
<input type="number" id="age" placeholder="ë‚˜ì´">
<input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
<button onclick="registerUser()">íšŒì›ê°€ì…</button>
<button onclick="loginUser()">ë¡œê·¸ì¸</button>
<p class="small" id="loginMsg"></p>
</div>

<!-- í™ˆ -->
<div id="home" class="screen">
<h2>ğŸ  ê±´ê°•ê´€ë¦¬ í™ˆ</h2>
<button onclick="showScreen('mental')">ğŸ§  ë©˜íƒˆ ê´€ë¦¬</button>
<button onclick="showScreen('sleep')">ğŸŒ™ ìˆ˜ë©´ ê¸°ë¡</button>
<button onclick="showScreen('food')">ğŸ¥— ìŒì‹ ì¶”ì²œ</button>
<button onclick="showScreen('game')">ğŸ® ë¯¸ë‹ˆê²Œì„</button>
<button onclick="showScreen('chat')">ğŸ—¨ï¸ AI ìƒë‹´</button>
<p class="small" id="welcomeMsg"></p>
</div>

<!-- ë©˜íƒˆ -->
<div id="mental" class="screen">
<h2>ğŸ§ ë‚´ ìºë¦­í„°</h2>
<div class="character" id="char">ğŸ˜</div>
<p class="small" id="charState"></p>
<h2>ì˜¤ëŠ˜ ë©˜íƒˆ ì„ íƒ</h2>
<button onclick="setMood('ğŸ˜„')">ì¢‹ìŒ</button>
<button onclick="setMood('ğŸ˜')">ë³´í†µ</button>
<button onclick="setMood('ğŸ˜¢')">ë‚˜ì¨</button>
<button onclick="setMood('ğŸ¥±')">ì¡¸ë¦¼</button>
<button onclick="setMood('ğŸ˜')">ì‹ ë‚¨</button>
<button class="backBtn" onclick="showScreen('home')">â¬…ï¸ í™ˆìœ¼ë¡œ</button>
</div>

<!-- ìˆ˜ë©´ -->
<div id="sleep" class="screen">
<h2>ğŸŒ™ ìˆ˜ë©´ ê¸°ë¡</h2>
<label>ìëŠ” ì‹œê°„</label>
<input type="number" id="sleepStartHour" placeholder="ì‹œê°„ (0~12)">
<select id="sleepStartAMPM"><option>ì˜¤ì „</option><option>ì˜¤í›„</option></select>
<label>ì¼ì–´ë‚˜ëŠ” ì‹œê°„</label>
<input type="number" id="sleepEndHour" placeholder="ì‹œê°„ (0~12)">
<select id="sleepEndAMPM"><option>ì˜¤ì „</option><option>ì˜¤í›„</option></select>
<button onclick="saveSleep()">ì €ì¥</button>
<p class="small" id="sleepMsg"></p>
<button class="backBtn" onclick="showScreen('home')">â¬…ï¸ í™ˆìœ¼ë¡œ</button>
</div>

<!-- ìŒì‹ -->
<div id="food" class="screen">
<h2>ğŸ¥— ì˜¤ëŠ˜ì˜ ì¶”ì²œ ìŒì‹</h2>
<select id="foodCategory">
<option value="all">ì „ì²´</option>
<option value="protein">ë‹¨ë°±ì§ˆ</option>
<option value="fruit">ê³¼ì¼</option>
<option value="veg">ì±„ì†Œ</option>
<option value="snack">ê°„ì‹</option>
<option value="supplement">ê±´ê°•ì‹í’ˆ</option>
<option value="nuts">ê²¬ê³¼ë¥˜</option>
</select>
<p id="foodText"></p>
<button onclick="recommendFood()">ë‹¤ì‹œ ì¶”ì²œ</button>
<button class="backBtn" onclick="showScreen('home')">â¬…ï¸ í™ˆìœ¼ë¡œ</button>
</div>

<!-- ë¯¸ë‹ˆê²Œì„ -->
<div id="game" class="screen">
<h2>ğŸ® ë¯¸ë‹ˆê²Œì„</h2>
<p id="gameQ"></p>
<input type="text" id="gameAns" placeholder="ì •ë‹µ ì…ë ¥">
<button onclick="checkGame()">ì œì¶œ</button>
<p class="small" id="gameMsg"></p>
<button onclick="nextGame()">ë‹¤ìŒ ë¬¸ì œ</button>
<button class="backBtn" onclick="showScreen('home')">â¬…ï¸ í™ˆìœ¼ë¡œ</button>
</div>

<!-- AI ìƒë‹´ -->
<div id="chat" class="screen">
<h2>ğŸ—¨ï¸ AI ìƒë‹´</h2>
<div class="chat-box" id="chatBox"></div>
<input type="text" id="userChat" placeholder="ë§ì„ ì…ë ¥í•˜ê³  ì—”í„°">
<button class="backBtn" onclick="showScreen('home')">â¬…ï¸ í™ˆìœ¼ë¡œ</button>
</div>

</div>

<script>
// ---------------- SPA í™”ë©´ ----------------
function showScreen(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// ---------------- íšŒì›ê°€ì…/ë¡œê·¸ì¸ ----------------
let users=JSON.parse(localStorage.getItem("users")||"{}");
let currentUser=null;
let userData={mood:"ğŸ˜",sleep:"",chat:[],foodHistory:[]};

function registerUser(){
  const name=document.getElementById("username").value.trim();
  const age=parseInt(document.getElementById("age").value);
  const pw=document.getElementById("password").value;
  if(!name||isNaN(age)||!pw){document.getElementById("loginMsg").textContent="ëª¨ë“  ì •ë³´ë¥¼ ì…ë ¥!";return;}
  if(users[name]){document.getElementById("loginMsg").textContent="ì´ë¯¸ ì¡´ì¬";}
  else{
    users[name]={age:age,password:pw,mood:"ğŸ˜",chat:[],sleep:"",foodHistory:[]};
    localStorage.setItem("users",JSON.stringify(users));
    document.getElementById("loginMsg").textContent="ê°€ì… ì™„ë£Œ!";
  }
}

function loginUser(){
  const name=document.getElementById("username").value.trim();
  const pw=document.getElementById("password").value;
  if(users[name]&&users[name].password===pw){
    currentUser=name;
    document.getElementById("welcomeMsg").textContent=`í™˜ì˜í•©ë‹ˆë‹¤, ${currentUser}ë‹˜ (ë‚˜ì´:${users[currentUser].age})`;
    userData=users[currentUser];
    char.textContent=userData.mood||"ğŸ˜";
    charState.textContent="";
    showScreen('home');
  }else{
    document.getElementById("loginMsg").textContent="ë¡œê·¸ì¸ ì‹¤íŒ¨!";
  }
}

// ---------------- ë©˜íƒˆ ----------------
const char=document.getElementById("char");
const charState=document.getElementById("charState");
const positiveComments={"ğŸ˜„":["ì¢‹ì€ í•˜ë£¨ì˜ˆìš”!","ë¯¸ì†Œê°€ ë©‹ì ¸ìš”!"],
                        "ğŸ˜":["ê´œì°®ì•„ìš”, ì²œì²œíˆ í•´ë„ ë¼ìš”!"],
                        "ğŸ˜¢":["í˜ë“¤ê² ì§€ë§Œ ì˜ ë²„í‹°ê³  ìˆì–´ìš”!"],
                        "ğŸ¥±":["ì¡¸ë¦¬êµ°ìš”, ì ê¹ ëˆˆ ë¶™ì´ì„¸ìš”!"],
                        "ğŸ˜":["ì˜¤ëŠ˜ ê¸°ë¶„ ì¢‹ë„¤ìš”!"]};
function setMood(e){
  char.textContent=e;
  const comments=positiveComments[e];
  const msg=comments[Math.floor(Math.random()*comments.length)];
  charState.textContent=msg;
  userData.mood=e;
  if(currentUser){users[currentUser].mood=e;localStorage.setItem("users",JSON.stringify(users));}
}

// ---------------- ìˆ˜ë©´ ----------------
function saveSleep(){
  const start=parseInt(document.getElementById("sleepStartHour").value);
  const end=parseInt(document.getElementById("sleepEndHour").value);
  const startH=start+(document.getElementById("sleepStartAMPM").value=="ì˜¤í›„"?12:0);
  const endH=end+(document.getElementById("sleepEndAMPM").value=="ì˜¤í›„"?12:0);
  let dur=endH-startH; if(dur<=0) dur+=24;
  userData.sleep=dur;
  document.getElementById("sleepMsg").textContent=dur<6?"ìˆ˜ë©´ ë¶€ì¡± ğŸ˜µ":dur>9?"ìˆ˜ë©´ ê³¼ë‹¤ ğŸ˜´":"ì ì ˆ ğŸ‘";
  if(currentUser){users[currentUser].sleep=dur;localStorage.setItem("users",JSON.stringify(users));}
}

// ---------------- ìŒì‹ ----------------
const foodList=[...Array(500).keys()].map(i=>({name:"ìŒì‹ìƒ˜í”Œ"+(i+1),cat:["protein","fruit","veg","snack","supplement","nuts"][i%6]}));
function recommendFood(){
  const cat=document.getElementById("foodCategory").value;
  let filtered=foodList; if(cat!=="all") filtered=foodList.filter(f=>f.cat===cat);
  const f=filtered[Math.floor(Math.random()*filtered.length)];
  document.getElementById("foodText").textContent=f.name;
  if(currentUser){users[currentUser].foodHistory.push(f.name);localStorage.setItem("users",JSON.stringify(users));}
}

// ---------------- ë¯¸ë‹ˆê²Œì„ ----------------
let gameQList=[{q:"í•˜ë£¨ ê¶Œì¥ ë¬¼ ì„­ì·¨ëŸ‰?",a:"1.5~2l"},{q:"ìŠ¤íŠ¸ë ˆìŠ¤ í•´ì†Œ ì¢‹ì€ í™œë™?",a:"ì‚°ì±…"},{q:"ê°„ë‹¨í•œ ê±´ê°• ìŠµê´€?",a:"ìŠ¤íŠ¸ë ˆì¹­"},{q:"ê°„ë‹¨í•œ ìš´ë™?",a:"íŒ”êµ½í˜€í´ê¸°"},{q:"í•˜ë£¨ ê¶Œì¥ ì•¼ì±„ ì„­ì·¨ëŸ‰?",a:"400g"},{q:"ì§§ì€ ëª…ìƒ ì‹œê°„?",a:"5ë¶„"}];
let currentGame;
function nextGame(){
  currentGame=gameQList[Math.floor(Math.random()*gameQList.length)];
  document.getElementById("gameQ").textContent=currentGame.q;
  document.getElementById("gameAns").value="";
  document.getElementById("gameMsg").textContent="";
}
function checkGame(){
  const ans=document.getElementById("gameAns").value.trim().toLowerCase();
  if(ans==currentGame.a.toLowerCase()){
    document.getElementById("gameMsg").textContent="âœ… ì •ë‹µ! í•´ê²° ë°©ë²• ìˆ˜í–‰ ì™„ë£Œ";
    char.textContent="ğŸ˜„";
  }else{
    document.getElementById("gameMsg").textContent="âŒ í‹€ë ¸ì–´ìš”! ì •ë‹µ: "+currentGame.a;
    char.textContent="ğŸ˜¢";
  }
}
nextGame();

// ---------------- AI ìƒë‹´ ----------------
const chatBox=document.getElementById("chatBox");
const aiBrain=[
  {k:["ì•ˆë…•","í•˜ì´","ì•ˆë…•í•˜ì„¸ìš”"],r:["ì•ˆë…•í•˜ì„¸ìš”! ì˜¤ëŠ˜ ê¸°ë¶„ì€ ì–´ë•Œìš”?","í•˜ì´! ì–´ë–¤ í•˜ë£¨ì˜€ë‚˜ìš”?"]},
  {k:["í˜ë“¤","ìš°ìš¸","ìŠ¬í””"],r:["ì¡°ê¸ˆ í˜ë“œì‹œê² ì–´ìš”. ì ê¹ ì‰¬ê±°ë‚˜ ì‚°ì±… ì¶”ì²œí•´ìš”.","ë§ˆìŒì´ í˜ë“¤ ë•ŒëŠ” ê¹Šê²Œ ìˆ¨ì‰¬ê³  ìŠ¤íŠ¸ë ˆì¹­ í•´ë³´ì„¸ìš”."]},
  {k:["ë°°ê³ íŒŒ","ë¨¹ê³ ì‹¶ì–´"],r:["ë‹¨ë°±ì§ˆì´ë‚˜ ê³¼ì¼ ì¶”ì²œ ë“œë ¤ìš”! ğŸ","ê°„ë‹¨í•˜ê²Œ ìš”ê±°íŠ¸ë‚˜ ê²¬ê³¼ë¥˜ë„ ì¢‹ì•„ìš”."]},
  {k:["ì¡¸ë ¤","í”¼ê³¤"],r:["ì ê¹ ëˆˆ ë¶™ì´ê±°ë‚˜ ì»¤í”¼ í•œì” ì–´ë– ì„¸ìš”?","ì§§ê²Œ ìŠ¤íŠ¸ë ˆì¹­ í›„ íœ´ì‹ ì¶”ì²œ"]},
  {k:["ë¶ˆì•ˆ","ê±±ì •"],r:["ì‹¬í˜¸í¡ 5íšŒ, ë§ˆìŒ ì•ˆì •ì‹œí‚¤ê¸° ì¢‹ì•„ìš”.","ë§ˆìŒì„ ê¸€ë¡œ ì ì–´ë³´ëŠ” ê²ƒë„ ë„ì›€ì´ ë©ë‹ˆë‹¤."]},
  {k:["ê³µë¶€","ì§‘ì¤‘"],r:["ì‘ì€ ëª©í‘œë¥¼ ë‚˜ëˆ„ì–´ ë‹¬ì„±í•´ë³´ì„¸ìš”.","5ë¶„ ë‹¨ìœ„ ì§‘ì¤‘ í›„ íœ´ì‹ ì¶”ì²œ"]},
  {k:["ìŠ¤íŠ¸ë ˆìŠ¤"],r:["ì§§ì€ ì‚°ì±…, ê·¸ë¦¼ ê·¸ë¦¬ê¸° ì¶”ì²œ ğŸ¨","ì°¨ í•œì” í•˜ë©´ì„œ ë§ˆìŒì„ ì•ˆì •ì‹œí‚¤ì„¸ìš”."]},
  {k:["ê°ì‚¬","ì¢‹ì•„ìš”"],r:["ì¢‹ì€ ë§ˆìŒ ìœ ì§€! ğŸ˜Š","ê¸ì •ì ì¸ í•˜ë£¨ ë³´ë‚´ì„¸ìš”!"]}
];
document.getElementById("userChat").addEventListener("keydown",function(e){
  if(e.key==="Enter"){
    const msg=this.value.trim(); if(!msg)return; this.value="";
    chatBox.innerHTML+=`<div class="chat-user">ğŸ™‚ ${msg}</div>`;
    let reply="ì¡°ê¸ˆ ë” êµ¬ì²´ì ìœ¼ë¡œ ë§ì”€í•´ì£¼ì‹¤ë˜ìš”?";
    const m=msg.toLowerCase();
    for(let i=0;i<aiBrain.length;i++){
      if(aiBrain[i].k.some(kw=>m.includes(kw))){
        reply=aiBrain[i].r[Math.floor(Math.random()*aiBrain[i].r.length)];
        break;
      }
    }
    chatBox.innerHTML+=`<div class="chat-ai">ğŸ¤ ${reply}</div>`;
    chatBox.scrollTop=chatBox.scrollHeight;
    if(currentUser){users[currentUser].chat.push({u:msg,a:reply});localStorage.setItem("users",JSON.stringify(users));}
  }
});
</script>
</body>
</html>

<!-- deploy test -->
